---
layout: post
title: Easily SSH into Amazon EC2 Instances 
---

h1. {{ page.title }}

When you're working with Amazon ec2 instances you'll ocasionally find yourself needing to ssh into them when you need to debug things like startup failures. However using the standard command line tools from Amazon is a bit of a pain because you have to call <strong>ec2-describe-instances</strong>, find the public dns name in the output and then <strong>ssh</strong> into the instance. What a waste of time.

Instead why not use the "Amazon Ruby SDK":https://github.com/aws/aws-sdk-ruby to make a useful script to ssh us into the instance.


Assuming you have installed the SDK

{% highlight ruby %}

  gem install aws-sdk

{% endhighlight %}


Just put this script somewhere on your path, eg. ec2ssh

{% highlight ruby %}

#! /usr/bin/env ruby

require 'aws-sdk'
require 'optparse'

options = {
  :region      => "us-east-1", # default
  :instance_id => ARGV[0]
}

OptionParser.new do |opts|
  opts.banner = "Usage: ec2ssh.rb <instance_id> [-r region]"

  opts.on("-r", "--region [region]", "AWS Region") do |r|
    options[:region] = r
  end
end.parse!

ec2 = AWS::EC2.new
region = ec2.regions[options[:region]]
url = region.instances[options[:instance_id]].public_dns_name
system "ssh #{url}"

{% endhighlight %}


And off you go!

{% highlight ruby %}

./ec2ssh i-abcdif -r us-west-1 # ssh into the instance

{% endhighlight %}
